<!DOCTYPE html>
<html>

<head>
    <title>Laptop AR Legend Interface</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script
        src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
</head>

<body>
    <a-scene cursor="fuse: false; rayOrigin: mouse" raycaster="objects: .interactable, .legend-btn">
        <a-assets>
            <a-mixin id="part-material" material="metalness: 0.8; roughness: 0.2; color: #2c3e50"></a-mixin>
            <a-mixin id="label-text" text="align: center; width: 2.5; color: #00f2ff; font: exo2bold"></a-mixin>
            <a-mixin id="btn-geo" geometry="primitive: plane; width: 0.6; height: 0.15"></a-mixin>
            <a-mixin id="btn-mat" material="color: #111; opacity: 0.8; transparent: true"></a-mixin>
        </a-assets>

        <a-entity
            environment="preset: contact; lighting: point; groundColor: #050505; grid: dots; gridColor: #222"></a-entity>

        <a-entity id="laptop-rig" position="0 1 -3" rotation="0 30 0">
            <a-entity id="screen-assembly" position="0 0.5 -0.45" class="interactable">
                <a-box width="1.3" height="0.85" depth="0.04" mixin="part-material"></a-box>
                <a-box id="lcd" width="1.2" height="0.75" depth="0.01" position="0 0 0.03"
                    material="color: #000; emissive: #002244"></a-box>
                <a-text value="STATUS: OPTIMAL\n4K PANEL ACTIVE" position="0 0 0.05" mixin="label-text" visible="false"
                    id="info-screen"></a-text>
            </a-entity>

            <a-entity id="cpu-node" position="0.25 0.05 -0.1" class="interactable">
                <a-box width="0.18" height="0.04" depth="0.18" color="#c0c0c0"></a-box>
                <a-text value="TEMP: 42C\nLOAD: 12%" position="0 0.4 0" mixin="label-text" visible="false"
                    id="info-cpu"></a-text>
            </a-entity>

            <a-entity id="gpu-node" position="-0.25 0.05 -0.2" class="interactable">
                <a-box width="0.2" height="0.04" depth="0.2" color="#76b900"></a-box>
                <a-text value="RTX 4080\nVRAM: 16GB" position="0 0.4 0" mixin="label-text" visible="false"
                    id="info-gpu"></a-text>
            </a-entity>

            <a-entity id="battery-node" position="0 0.02 0.3" class="interactable">
                <a-box width="0.7" height="0.04" depth="0.25" color="#111"></a-box>
                <a-text value="HEALTH: 98%\nREMAINING: 8h" position="0 0.4 0" mixin="label-text" visible="false"
                    id="info-battery"></a-text>
            </a-entity>
        </a-entity>

        <a-camera position="0 1.8 1.5">
            <a-cursor color="#00f2ff"></a-cursor>

            <a-entity position="0.8 -0.5 -1" rotation="-10 -20 0">
                <a-plane width="0.7" height="0.8" material="color: #000; opacity: 0.5" position="0 0 -0.01"></a-plane>
                <a-text value="SYSTEM DIAGNOSTICS" position="0 0.32 0" align="center" width="1.5"
                    color="#5EFBFF"></a-text>

                <a-entity id="btn-cpu" class="legend-btn" mixin="btn-geo btn-mat" position="0 0.15 0"
                    onclick="highlight('cpu')">
                    <a-text value="CPU STATUS" align="center" width="1.2"></a-text>
                </a-entity>
                <a-entity id="btn-gpu" class="legend-btn" mixin="btn-geo btn-mat" position="0 -0.02 0"
                    onclick="highlight('gpu')">
                    <a-text value="GPU STATUS" align="center" width="1.2"></a-text>
                </a-entity>
                <a-entity id="btn-bat" class="legend-btn" mixin="btn-geo btn-mat" position="0 -0.19 0"
                    onclick="highlight('battery')">
                    <a-text value="BATTERY" align="center" width="1.2"></a-text>
                </a-entity>
                <a-entity id="btn-reset" class="legend-btn" mixin="btn-geo btn-mat" position="0 -0.36 0"
                    onclick="resetAll()" material="color: #441111">
                    <a-text value="RESET VIEW" align="center" width="1.2"></a-text>
                </a-entity>
            </a-entity>
        </a-camera>
    </a-scene>

    <script>
        function highlight(part) {
            // Hide all info labels first
            document.querySelectorAll("[id^='info-']").forEach(l => l.setAttribute("visible", false));

            // Highlight specific part
            const target = document.querySelector(`#${part}-node`);
            const label = document.querySelector(`#info-${part}`);

            if (label) label.setAttribute("visible", true);

            // Pop effect
            target.setAttribute("animation__pop", {
                property: 'scale',
                from: '1 1 1',
                to: '1.2 1.2 1.2',
                dur: 300,
                dir: 'alternate',
                loop: 2
            });

            // Color highlight the button
            document.querySelectorAll(".legend-btn").forEach(b => b.setAttribute("material", "color", "#111"));
            document.querySelector(`#btn-${part.substring(0, 3)}`).setAttribute("material", "color", "#00f2ff");
        }

        function resetAll() {
            document.querySelectorAll("[id^='info-']").forEach(l => l.setAttribute("visible", false));
            document.querySelectorAll(".legend-btn").forEach(b => b.setAttribute("material", "color", "#111"));
        }

        // Keep the original Click-to-Explode logic
        let exploded = false;
        document.body.addEventListener("click", function (e) {
            if (e.target.classList.contains('legend-btn')) return; // Don't explode if clicking legend

            if (!exploded) {
                animate("#battery-node", "0 1 1.2", "0 0 0");
                animate("#cpu-node", "0.8 1 -0.1", "0 45 0");
                animate("#gpu-node", "-0.8 1 -0.1", "0 -45 0");
                animate("#screen-assembly", "0 2 -1.2", "-30 0 0");
                exploded = true;
            }
        });

        function animate(selector, pos, rot) {
            const el = document.querySelector(selector);
            el.setAttribute("animation__pos", { property: 'position', to: pos, dur: 1200, easing: 'easeOutExpo' });
            el.setAttribute("animation__rot", { property: 'rotation', to: rot, dur: 1200, easing: 'easeOutExpo' });
        }
    </script>
</body>

</html>